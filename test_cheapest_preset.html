<!DOCTYPE html>
<html>
<head>
    <title>Test Cheapest Preset</title>
</head>
<body>
    <h1>üß™ Testing Cheapest Preset Configuration</h1>
    <div id="results"></div>

    <script src="simulator.js"></script>
    <script>
        console.log("üß™ Testing cheapest preset configuration");

        // Test the cheapest configuration
        const cheapestParams = {
            mu: 0.1,
            nu: 0.0,
            H: 24,
            txsPerBatch: 100,
            minFee: 1e-8,
            targetBalance: 1.0,
            l1Volatility: 0.3,
            feeElasticity: 0.5
        };

        try {
            const simulator = new TaikoFeeSimulator(cheapestParams);

            console.log("‚úÖ Simulator created successfully");
            console.log("Gas per TX:", simulator.gasPerTx);
            console.log("Expected: 2000 gas");

            // Test with realistic basefee
            const testBasefee = 0.075e9; // 0.075 gwei
            const result = simulator.step(testBasefee, new Date());

            console.log("‚úÖ Simulation step completed");
            console.log("Fee (gwei):", result.fee * 1e9);
            console.log("L1 Cost (gwei):", result.l1Cost * 1e9);

            // Test preset loading
            console.log("Available presets:", Object.keys(PRESETS));
            const cheapestPreset = PRESETS['cheapest-fees'];
            console.log("Cheapest preset:", cheapestPreset);

            document.getElementById('results').innerHTML = `
                <h2>‚úÖ Test Results</h2>
                <p><strong>Gas per TX:</strong> ${simulator.gasPerTx} gas (expected: 2000)</p>
                <p><strong>Test Fee:</strong> ${(result.fee * 1e9).toFixed(6)} gwei</p>
                <p><strong>L1 Cost:</strong> ${(result.l1Cost * 1e9).toFixed(6)} gwei</p>
                <p><strong>Preset Available:</strong> ${cheapestPreset ? 'Yes' : 'No'}</p>
                <p><strong>Status:</strong> <span style="color: green;">All tests passed!</span></p>
            `;

        } catch (error) {
            console.error("‚ùå Test failed:", error);
            document.getElementById('results').innerHTML = `
                <h2>‚ùå Test Failed</h2>
                <p style="color: red;">Error: ${error.message}</p>
            `;
        }
    </script>
</body>
</html>